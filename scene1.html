<!DOCTYPE html>
<meta charset="utf-8">

<h1>Understanding the Catch-Up Effect</h1>
<p1>The <b>"catch-up effect"</b> theorizes that less developed economies will catch up to more developed ones. The theory posits that the per capita GDP of countries will eventually converge to a natural ceiling. This ceiling  represents the slow growth of the most developed countries, meaning that less developed countries will tend to experience higher growth vs. the more developed ones (at least once they transition from a subsistence economy to an industrialized one). This theory makes intuitive sense - it is easier and cheaper to adopt existing technologies that can increase productivity than to invent new ones. </p1><br></br>
<p2>However, there are a number of ways this effect can be limited that we will explore in the chart below, which is showing Per Capita GDP (in $USD) of various countries over time.</p2>

<!-- Add button -->
<br><p3>
<a href="https://jtwells2.github.io/UIUC-MCS/index.html">
    <button>Continue --></button>
</a></p3>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v6.js"></script>

<!-- Load d3-annotation -->
<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>

<svg id="John_Wells_Data_Visualization" 
	width="900" 
    height ="900" 
    style="stroke: rgb(0, 0, 0); stroke-width: 0.6;">
</svg>

<script>

	//Define constants
    const chartWidth = 800
    const chartHeight = 500
    const marginTop = 30
    const marginBot = 100
    const marginLeft = 70
    const marginRight = 30
    const transitionDuration = 1000 
    
    //Fixed list of countries for the visualization
    const countries = ["Argentina","Australia","Brazil","Canada","China",
  	"France","Germany","India","Indonesia","Italy","Japan","Mexico","Russia",
  	"Saudi Arabia","South Africa","South Korea","Turkey","United Kingdom",
  	"United States","European Union"]
    
    //Fixed list of colors for each country, for consistency
    //These are bolder colors that help with my colorblindness better than the prebuilt color scales
    const myColor = d3.scaleOrdinal(countries,["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"]);

  //Append the svg object where the chart will be created
const svg = d3.select("#John_Wells_Data_Visualization")
  .append("svg")
    .attr("width", chartWidth + marginLeft + marginRight)
    .attr("height", chartHeight + marginTop + marginBot)
  	.append("g")
    	.attr("transform", "translate("+marginLeft+","+marginTop+")");
    
const annotations = [
  {
    note: {
      label: "This chart shows the GDP per capita (in $USD) of the US and Japan.",
      bgPadding: 10
    },
    connector: {
      end: "none",        // Can be none, or arrow or dot
      type: "line",      // ?? don't know what it does
      lineType : "vertical",    // ?? don't know what it does
      endScale: 5     // dot size
    },
    color: ["black"],
    x: 250,
    y: 200,
  	dy: 150,
  	dx: 300,
  	subject: {
    	radius: 150,
    	radiusPadding: 0
  }
}]

const type = d3.annotationCalloutCircle
// Add annotation to the chart
const makeAnnotations = d3.annotation()
  .notePadding(15)
  .type(type)
  .annotations(annotations)
d3.select("#John_Wells_Data_Visualization")
  .append("g")
  .call(makeAnnotations)

//Read the data
d3.csv("https://raw.githubusercontent.com/jtwells2/UIUC-MCS/main/G20_GDP_Data").then( function(data) {


    //Add X-axis and Date label
  const x = d3.scaleLinear()
    .domain(d3.extent(data, function(d) { return +d.Year; }))
    .range([0, chartWidth]);
  svg.append("g")
    .attr("transform", "translate(0,"+chartHeight+")")
    .call(d3.axisBottom(x).ticks(10));
      
  svg.append("text")
    .attr("text-anchor", "middle")
    .attr("x", chartWidth / 2)
    .attr("y", chartHeight + marginBot - 50)
    .text("Year");

  // Y-Axis and Label (GDP Per Capita ($USD))
  const y = d3.scaleLinear()
    .domain([0, 52000])
    .range([chartHeight, 0]);
  svg.append("g")
    .call(d3.axisLeft(y).ticks(20));
    
  svg.append("text")
    .attr("text-anchor", "middle")
    .attr("transform","rotate(-90)")
    .attr("x", -chartHeight / 2)
    .attr("y", -marginLeft + 20)
    .text("GDP Per Capita ($USD)");
        
    //Generic function to update lines
 	function updateLine(selectedCountry,lineName) {
    	
 		//Filter data selection
      const dataFilter = data.map(function(d){return {Year: d.Year, GDP:d[selectedCountry]} })

      // Give these new data to update line
      lineName
      	.datum(dataFilter)
        .attr("d", d3.line()
           .x(function(d) { return x(+d.Year) })
           .y(function(d) { return y(+d.GDP) })
          )
         .attr("stroke", function(d){ return myColor(selectedCountry) })
         .style("stroke-width", 4)
       	 .style("fill", "none")
        .transition()
        .duration(1000)
    }
    
  	//Manually draw the lines we want to display
    const lineChina = svg.append('g').append("path")
	const lineJapan = svg.append('g').append("path")
    updateLine("China",lineChina);
    updateLine("Japan",lineJapan);

})
</script>
